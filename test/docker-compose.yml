web:
    image: mendix/nginx_azure
    ports:
        - 80:80
        - 443:443
    links:
        - mendixapp
        - vpcdeployer

mendixapp:
    image: mendix/mendix_azure:custom_m2ee
    environment:
        - DATABASETYPE=PostgreSQL
        - DATABASEHOSTNAME=db:5432
        - DATABASE_DB_NAME=mendix
        - DATABASEUSERNAME=mendix
        - DATABASEPASSWORD=mendix
        - ADMIN_PASSWORD=Password1!
        - PREF_KEY=fa07488f-2892-4adf-9743-9678a2e3809e
        - PREF_VALUE=LS0tLS1CRUdJTiBQR1AgU0lHTkVEIE1FU1NBR0UtLS0tLQpIYXNoOiBTSEExCgp7IkxpY2Vuc2VUeXBlIjoiUGVycGV0dWFsIiwiU2VwYXJhdGVBbm9ueW1vdXNVc2VycyI6ZmFsc2UsIlJ1bnRpbWVNb2RlIjoiUHJvZHVjdGlvbiIsIkNvbXBvbmVudHMiOlsiTW9iaWxlIl0sIkxpY2Vuc2VJRCI6IitCMHNhTmFTTUdLcXA1b0dsNnBlZDRYY091TT0iLCJDb21wYW55IjoiTWVuZGl4IiwiVXNlckxpbWl0YXRpb25zIjpbeyJOdW1iZXJPZkFsbG93ZWRVc2VycyI6NTAsIkxpbWl0YXRpb25UeXBlIjoiTmFtZWQiLCJBbW91bnRUeXBlIjoiU3BlY2lmaWVkIn0seyJMaW1pdGF0aW9uVHlwZSI6IkNvbmN1cnJlbnQiLCJBbW91bnRUeXBlIjoiVW5saW1pdGVkIn0seyJMaW1pdGF0aW9uVHlwZSI6IkNvbmN1cnJlbnRBbm9ueW1vdXMiLCJBbW91bnRUeXBlIjoiVW5saW1pdGVkIn1dfQotLS0tLUJFR0lOIFBHUCBTSUdOQVRVUkUtLS0tLQpWZXJzaW9uOiBCQ1BHIHYxLjQ1CgppUUpQQkFFQkFnQTVCUUpXQVRzTU1oeE5aVzVrYVhnZ1RHbGpaVzV6WlNCVGFXZHVhVzVuSUV0bGVTQThiR2xqClpXNXphVzVuUUcxbGJtUnBlQzVqYjIwK0FBb0pFSmpoek1PZXdOUmxVUWNRQUl0Qk5ZK2ZsQlJxMjNhWEEwK0sKQ1dJQnIvUTFZcjg1Znd6eWRha1RMRXlxcUwvWWlYSkpCVDFtbjFMajkyWkQ3cUF6VzBwamFwU1RpdDBBd3BwOQo4bGl3S2tKd3h5UFBXbGUyL28wQnR5N0drNXhvRjUxbEF1NUpwN1pKT25haW9XMUtOa2hJNFlwaFI3NlRBYzdVCjFlOXFaVVBKZVVrWjFHT1pTU1BxU3llVFpOWG9mTzAzdThsRjhMd1lZYU9oSmVHZERlKzMzTkxvWC90ZWlqbzcKS2g4SW50L0x3VzltYWJhZklPWFJlZnp2ZkVqeHVXaEg4VWJFOExlcVJ5dk5VS21kRjVVQ0x0NVl0N3EreVFFcgoxK3gxblRkWmlPdUMrZUM2VjFzM3FMUUVzVEdacnZ2MjFQaDIzMTMvSndkUk9TV0hMVlZyNGYzUzY0elhwd29OCnpTZnY3cmd6cGFKTTRHNS9NMkdDMnRXTy9qWFhPOUZKNytyTnpGQzZZSENubTJudS9GaWdtMGtFbzRPdHoyOHcKcW81eFJxbXJreFdaODBJeExXaXpZdU85Z0V2c2tsWGxpUzZQcHN4NGZpTjdRTnRDYlB5UUFkSFhVeHczL3hTNApNWHBZcUIrbHVlYmlRTFlFU05HUEgyb2J3YkQxYWxsbWN6TjhuWUR0Q0lNSzFJcm5XdENHOWk3d2R3NHNOQzZhClZTKzZXQTFOM3VRTitGTTlGMjF4QVpYSmlHYWhpbm5ydzZrZERyTFRoNG52ZzNVUXNxMVZPY2NUQmFJK09Xak4KenRYZlVadGtybVNHWlVWTzVlQmJFNVkzWFhERmprRkliL09DclRLcTNrM082OGIzcTgzcWJKV3ljNmpWYVlubwpoNHBPQjQ0Z1VWMXRPaU9tSVg3c1krTlYKPVVpUzAKLS0tLS1FTkQgUEdQIFNJR05BVFVSRS0tLS0tCg==
    volumes:
        - ./shared_volumes:/opt/mendix
    ports:
        - "8000"
    links:
        - db
    container_name: compose_mendixapp_1

vpcdeployer:
    image: mendix/vpcdeployer
    environment:
        - VPC_DB_TYPE=PostgreSQL
        - VPC_DB_HOSTNAME="deployerdb:5432"
        - VPC_DB_DATABASE=mendix
        - VPC_DB_USERNAME=mendix
        - VPC_DB_PASSWORD=mendix
        - VPC_ADMIN_PASSWORD=Password1!
        - VPC_PREF_KEY=fa07488f-2892-4adf-9743-9678a2e3809e
        - VPC_PREF_VALUE=LS0tLS1CRUdJTiBQR1AgU0lHTkVEIE1FU1NBR0UtLS0tLQpIYXNoOiBTSEExCgp7IkxpY2Vuc2VUeXBlIjoiUGVycGV0dWFsIiwiU2VwYXJhdGVBbm9ueW1vdXNVc2VycyI6ZmFsc2UsIlJ1bnRpbWVNb2RlIjoiUHJvZHVjdGlvbiIsIkNvbXBvbmVudHMiOlsiTW9iaWxlIl0sIkxpY2Vuc2VJRCI6IitCMHNhTmFTTUdLcXA1b0dsNnBlZDRYY091TT0iLCJDb21wYW55IjoiTWVuZGl4IiwiVXNlckxpbWl0YXRpb25zIjpbeyJOdW1iZXJPZkFsbG93ZWRVc2VycyI6NTAsIkxpbWl0YXRpb25UeXBlIjoiTmFtZWQiLCJBbW91bnRUeXBlIjoiU3BlY2lmaWVkIn0seyJMaW1pdGF0aW9uVHlwZSI6IkNvbmN1cnJlbnQiLCJBbW91bnRUeXBlIjoiVW5saW1pdGVkIn0seyJMaW1pdGF0aW9uVHlwZSI6IkNvbmN1cnJlbnRBbm9ueW1vdXMiLCJBbW91bnRUeXBlIjoiVW5saW1pdGVkIn1dfQotLS0tLUJFR0lOIFBHUCBTSUdOQVRVUkUtLS0tLQpWZXJzaW9uOiBCQ1BHIHYxLjQ1CgppUUpQQkFFQkFnQTVCUUpXQVRzTU1oeE5aVzVrYVhnZ1RHbGpaVzV6WlNCVGFXZHVhVzVuSUV0bGVTQThiR2xqClpXNXphVzVuUUcxbGJtUnBlQzVqYjIwK0FBb0pFSmpoek1PZXdOUmxVUWNRQUl0Qk5ZK2ZsQlJxMjNhWEEwK0sKQ1dJQnIvUTFZcjg1Znd6eWRha1RMRXlxcUwvWWlYSkpCVDFtbjFMajkyWkQ3cUF6VzBwamFwU1RpdDBBd3BwOQo4bGl3S2tKd3h5UFBXbGUyL28wQnR5N0drNXhvRjUxbEF1NUpwN1pKT25haW9XMUtOa2hJNFlwaFI3NlRBYzdVCjFlOXFaVVBKZVVrWjFHT1pTU1BxU3llVFpOWG9mTzAzdThsRjhMd1lZYU9oSmVHZERlKzMzTkxvWC90ZWlqbzcKS2g4SW50L0x3VzltYWJhZklPWFJlZnp2ZkVqeHVXaEg4VWJFOExlcVJ5dk5VS21kRjVVQ0x0NVl0N3EreVFFcgoxK3gxblRkWmlPdUMrZUM2VjFzM3FMUUVzVEdacnZ2MjFQaDIzMTMvSndkUk9TV0hMVlZyNGYzUzY0elhwd29OCnpTZnY3cmd6cGFKTTRHNS9NMkdDMnRXTy9qWFhPOUZKNytyTnpGQzZZSENubTJudS9GaWdtMGtFbzRPdHoyOHcKcW81eFJxbXJreFdaODBJeExXaXpZdU85Z0V2c2tsWGxpUzZQcHN4NGZpTjdRTnRDYlB5UUFkSFhVeHczL3hTNApNWHBZcUIrbHVlYmlRTFlFU05HUEgyb2J3YkQxYWxsbWN6TjhuWUR0Q0lNSzFJcm5XdENHOWk3d2R3NHNOQzZhClZTKzZXQTFOM3VRTitGTTlGMjF4QVpYSmlHYWhpbm5ydzZrZERyTFRoNG52ZzNVUXNxMVZPY2NUQmFJK09Xak4KenRYZlVadGtybVNHWlVWTzVlQmJFNVkzWFhERmprRkliL09DclRLcTNrM082OGIzcTgzcWJKV3ljNmpWYVlubwpoNHBPQjQ0Z1VWMXRPaU9tSVg3c1krTlYKPVVpUzAKLS0tLS1FTkQgUEdQIFNJR05BVFVSRS0tLS0tCg==
    volumes:
        - ./shared_volumes:/opt/mendix
        - /var/run/docker.sock:/var/run/docker.sock
    ports:
        - "9000"
        - "9001"
        - "9002"
    links:
        - deployerdb

db:
    image: postgres
    environment:
        - POSTGRES_USER=mendix
        - POSTGRES_PASSWORD=mendix

deployerdb:
    image: postgres
    environment:
        - POSTGRES_USER=mendix
        - POSTGRES_PASSWORD=mendix
    ports:
        - "5432"
